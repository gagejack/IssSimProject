package mainPackage;

import java.awt.Color;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.IOException;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JLayeredPane;
import javax.swing.JOptionPane;
import javax.swing.JPasswordField;
import javax.swing.JTextField;

public class UserCreationWindow {
	
	GUIControl guiObj = new GUIControl();
	SelectionWindow selectObj = new SelectionWindow();
	LoginUserWindow loginObj= new LoginUserWindow();

	private JFrame createFrame;
	private JLayeredPane createLayeredPane;
	
	private int createWidth = 400;
	private int createHeight = 275;
	private int createButtonX = 75;
	private int createButtonY = 190;
	
	private int backButtonX = 250;
	private int backButtonY = 190;
	private int backButtonWidth = 75;
	private int backButtonHeight = 25;
	
	private int userTextFieldX = 50;
	private int userTextFieldY = 50+ 20;
	private int passTextFieldX = 50;
	private int passTextFieldY = 120+ 20;
	private int userLabelX = 50;
	private int userLabelY = 20 + 20;
	private int passwordLabelX = 50;
	private int passwordLabelY = 90+ 20;
	
	private JLabel userLabel;
	private JTextField userText;
	
	private JLabel passLabel;
	private JTextField passText;
	
	private JButton createUserButton = new JButton();
	private JButton backButton = new JButton();
	
	// ------------------------------------- User Creation Window Window -------------------------------------

	
	public void openCreateWindow() throws IOException {
		createFrame = new JFrame();
		createFrame.setSize(createWidth,createHeight);
		createFrame.setLocationRelativeTo(null);
		createFrame.setLayout(null);
		
		createLayeredPane = new JLayeredPane();
		createLayeredPane.setBounds(0, 0, createWidth, createHeight);
		createFrame.add(createLayeredPane);
		createFrame.setResizable(false);
		createFrame.setVisible(true);
		
		setupUserStuff();
		setupPassStuff();
		
		
		guiObj.displayLoginBackground(createLayeredPane,createWidth,createHeight);
	        
		initializeCreateUserButton();
		initializeBackButton();
		
		setupButtonListeners();
		
		}
	
	public void setupUserStuff() {
		userLabel = new JLabel("Username: ");
        userLabel.setForeground(Color.WHITE);
        userLabel.setBounds(userLabelX,userLabelY,80,25);
        createLayeredPane.add(userLabel, Integer.valueOf(2));
        
		userText = new JTextField();
	    userText.setBounds(userTextFieldX,userTextFieldY,200,25);
	    createLayeredPane.add(userText,Integer.valueOf(2));
	}
	
	public void setupPassStuff() {
		passLabel = new JLabel("Password: ");
        passLabel.setForeground(Color.WHITE);
        passLabel.setBounds(passwordLabelX,passwordLabelY,80,25);
        createLayeredPane.add(passLabel,Integer.valueOf(2));
        
		passText = new JPasswordField();
        passText.setBounds(passTextFieldX,passTextFieldY,200,25);
        createLayeredPane.add(passText,Integer.valueOf(2));
	}
	
	public void setupButtonListeners() {
		ActionListener buttonListener = new ActionListener() {
			@Override
			public void actionPerformed(ActionEvent ae) {
				Object o = ae.getSource();
				
				if(o == createUserButton) {
					System.out.println("Create Button");
					String user = userText.getText();
	                String pass = new String(passText.getText());
	                UserInfo userInfo = new UserInfo();
	                if(userInfo.passwordValidate(pass) && userInfo.usernameValidate(user)) {
	                    JOptionPane.showMessageDialog(createFrame, "User " + user + " created successfully!");
	    				userInfo.saveUser(user, pass);
	    				createFrame.dispose();
						try {
							loginObj.openLoginWindow();
						} catch (IOException e) {
							// TODO Auto-generated catch block
							e.printStackTrace();
						}

	    				
	                } else if(userInfo.usernameValidate(user) == false) {
	                    JOptionPane.showMessageDialog(createFrame, "Username is already taken");
	                } else if(userInfo.passwordValidate(pass) == false) {
	                    JOptionPane.showMessageDialog(createFrame, "Password must contain a digit, an uppercase, and be 9 characters long");
	                }
	               
	                
				} else if(o == backButton) {
					createFrame.dispose();
					selectObj.openSelectionWindow();
				}
			}
		};
		
		createUserButton.addActionListener(buttonListener);
		backButton.addActionListener(buttonListener);
	}
	
	public void initializeCreateUserButton() {
		createUserButton = new JButton("Create User");
        createUserButton.setBounds(createButtonX, createButtonY, 150, 25);
        createLayeredPane.add(createUserButton,Integer.valueOf(2));
	}
	
	public void initializeBackButton() {
		backButton = new JButton("Back");
        backButton.setBounds(backButtonX, backButtonY, backButtonWidth, backButtonHeight);
        createLayeredPane.add(backButton,Integer.valueOf(2));
	}
}
